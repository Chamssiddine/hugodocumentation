<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Ansible | Remote Dev Env</title><meta name=keywords content><meta name=description content="Run Ansible Playbook For the time being we will use bash scripts to play our playbook, so we have a couple of bash scripts to fix some problems with ssh connection due to terraform not working as it should, the key folder structure is:
│──── playbook
├── README.md
├── change_to_new_hosts.bash
├── copy_ansible_playbook_to_workstations.bash
├── docker_playbook.yml
├── hosts ├── packages_playbook.yaml
└── start_ansible_playbook.bash
│──── ssh_scripts
├── README.md
├── authorized_keys
├── remove_knowhost_beforeanything.bash
├── send_my_ssh_key_to_workstation.bash"><meta name=author content><link rel=canonical href=http://example.org/posts/ansible/><link crossorigin=anonymous href=/assets/css/stylesheet.3613efbd0b1772781e8f49935e973cae632a7f61471c05b17be155505ccf87b5.css integrity="sha256-NhPvvQsXcngej0mTXpc8rmMqf2FHHAWxe+FVUFzPh7U=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=http://example.org/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://example.org/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://example.org/favicon-32x32.png><link rel=apple-touch-icon href=http://example.org/apple-touch-icon.png><link rel=mask-icon href=http://example.org/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Ansible"><meta property="og:description" content="Run Ansible Playbook For the time being we will use bash scripts to play our playbook, so we have a couple of bash scripts to fix some problems with ssh connection due to terraform not working as it should, the key folder structure is:
│──── playbook
├── README.md
├── change_to_new_hosts.bash
├── copy_ansible_playbook_to_workstations.bash
├── docker_playbook.yml
├── hosts ├── packages_playbook.yaml
└── start_ansible_playbook.bash
│──── ssh_scripts
├── README.md
├── authorized_keys
├── remove_knowhost_beforeanything.bash
├── send_my_ssh_key_to_workstation.bash"><meta property="og:type" content="article"><meta property="og:url" content="http://example.org/posts/ansible/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-01-18T14:55:57+01:00"><meta property="article:modified_time" content="2023-01-18T14:55:57+01:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Ansible"><meta name=twitter:description content="Run Ansible Playbook For the time being we will use bash scripts to play our playbook, so we have a couple of bash scripts to fix some problems with ssh connection due to terraform not working as it should, the key folder structure is:
│──── playbook
├── README.md
├── change_to_new_hosts.bash
├── copy_ansible_playbook_to_workstations.bash
├── docker_playbook.yml
├── hosts ├── packages_playbook.yaml
└── start_ansible_playbook.bash
│──── ssh_scripts
├── README.md
├── authorized_keys
├── remove_knowhost_beforeanything.bash
├── send_my_ssh_key_to_workstation.bash"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://example.org/posts/"},{"@type":"ListItem","position":2,"name":"Ansible","item":"http://example.org/posts/ansible/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Ansible","name":"Ansible","description":"Run Ansible Playbook For the time being we will use bash scripts to play our playbook, so we have a couple of bash scripts to fix some problems with ssh connection due to terraform not working as it should, the key folder structure is:\n│──── playbook\n├── README.md\n├── change_to_new_hosts.bash\n├── copy_ansible_playbook_to_workstations.bash\n├── docker_playbook.yml\n├── hosts ├── packages_playbook.yaml\n└── start_ansible_playbook.bash\n│──── ssh_scripts\n├── README.md\n├── authorized_keys\n├── remove_knowhost_beforeanything.bash\n├── send_my_ssh_key_to_workstation.bash","keywords":[],"articleBody":"Run Ansible Playbook For the time being we will use bash scripts to play our playbook, so we have a couple of bash scripts to fix some problems with ssh connection due to terraform not working as it should, the key folder structure is:\n│──── playbook\n├── README.md\n├── change_to_new_hosts.bash\n├── copy_ansible_playbook_to_workstations.bash\n├── docker_playbook.yml\n├── hosts ├── packages_playbook.yaml\n└── start_ansible_playbook.bash\n│──── ssh_scripts\n├── README.md\n├── authorized_keys\n├── remove_knowhost_beforeanything.bash\n├── send_my_ssh_key_to_workstation.bash\n└── ssh.bash\nWe neet to transfer our public keys to each of the workstation, so we run these cmd in order we will remote any old know host to prevent any conflict: $ bash remove_knowhost_beforeanything.bash\nWe will create.ssh folder and send the file authorized_keys which contain our public key for all the 3 VMs we have: $ bash send_my_ssh_key_to_workstation.bash\nLast part is play the ansible playbook, we have two for the time being one is for installing docker and the other one is for installing multiple tools for our developers. we will create the hosts file with the new Publis IP of the VMs $ bash change_to_new_hosts.bash Afterward we run the playbooks for all the VMs\n$ bash start_ansible_playbook.bash\nNOTE: if you want to not use ssh and cp the playbook inside the vm and run it locally of course change the playbook you want to copy\n$ bash copy_ansible_playbook_to_workstations.bash\n","wordCount":"220","inLanguage":"en","datePublished":"2023-01-18T14:55:57+01:00","dateModified":"2023-01-18T14:55:57+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://example.org/posts/ansible/"},"publisher":{"@type":"Organization","name":"Remote Dev Env","logo":{"@type":"ImageObject","url":"http://example.org/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://example.org/ accesskey=h title="Remote Dev Env (Alt + H)">Remote Dev Env</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://example.org/ title=Home><span>Home</span></a></li><li><a href=http://example.org/posts/aboutus title="About Us"><span>About Us</span></a></li><li><a href=http://example.org/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Ansible</h1><div class=post-meta><span title='2023-01-18 14:55:57 +0100 CET'>January 18, 2023</span></div></header><div class=post-content><h1 id=run-ansible-playbook>Run Ansible Playbook<a hidden class=anchor aria-hidden=true href=#run-ansible-playbook>#</a></h1><p>For the time being we will use bash scripts to play our playbook, so we have a couple of bash scripts to fix some problems with ssh connection due to terraform not working as it should, the key folder structure is:</p><p>│──── playbook<br>   ├── README.md<br>   ├── change_to_new_hosts.bash<br>   ├── copy_ansible_playbook_to_workstations.bash<br>   ├── docker_playbook.yml<br>   ├── hosts<br>   ├── packages_playbook.yaml<br>   └── start_ansible_playbook.bash<br>│──── ssh_scripts<br>   ├── README.md<br>   ├── authorized_keys<br>   ├── remove_knowhost_beforeanything.bash<br>   ├── send_my_ssh_key_to_workstation.bash<br>   └── ssh.bash</p><ul><li>We neet to transfer our public keys to each of the workstation, so we run these cmd in order
we will remote any old know host to prevent any conflict:</li></ul><p><code>$ bash remove_knowhost_beforeanything.bash</code><br></p><ul><li>We will create.ssh folder and send the file authorized_keys which contain our public key for all the 3 VMs we have:</li></ul><p><code>$ bash send_my_ssh_key_to_workstation.bash</code></p><ul><li><p>Last part is play the ansible playbook, we have two for the time being one is for installing docker and the other one is for installing multiple tools for our developers. we will create the hosts file with the new Publis IP of the VMs<br><code>$ bash change_to_new_hosts.bash</code><br></p></li><li><p>Afterward we run the playbooks for all the VMs</p></li></ul><p><code>$ bash start_ansible_playbook.bash</code></p><hr><p>NOTE: if you want to not use ssh and cp the playbook inside the vm and run it locally of course change the playbook you want to copy</p><p><code>$ bash copy_ansible_playbook_to_workstations.bash</code></p></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>&copy; 2023 <a href=http://example.org/>Remote Dev Env</a></span>
<span><a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank></a>
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank></a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>